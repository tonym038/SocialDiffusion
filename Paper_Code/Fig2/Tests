g=1.5
Total_equals=[]
n=4
old=[0;1;1;0]
x=old
G=ones(n,n)
for v=1:n
    equals=-1
    for w=1:n
        if old(v)==old(w)
            equals=equals+1
            G(w,v)=g
        end
        if w==v
            G(w,v)=0
        end
    end
    Total_equals=[Total_equals equals]
end
Total_unequals=n-1-Total_equals
%G=[0 1 g 1; 1 0 1 1; 1 g 0 1; g g 1 0]
%a_base=[1 2 3 4]
b=[1 2 3 4]
a_base  = b./(g*Total_equals + Total_unequals)
denominator=(g*Total_equals + Total_unequals)
a_all=a_base.*G
P=x.*a_all
S_C=sum(P,1)